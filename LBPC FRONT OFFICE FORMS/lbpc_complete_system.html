<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LBPC Surplus Recovery System - Enhanced</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e6ed;
            padding-bottom: 0;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 20px;
            background: transparent;
            border: none;
            color: #64748b;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #1e3c72;
        }

        .tab.active {
            color: #1e3c72;
            border-bottom-color: #1e3c72;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid #1e3c72;
        }

        .stat-card h3 {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: 700;
            color: #1e3c72;
        }

        .stat-card .change {
            font-size: 13px;
            color: #10b981;
            margin-top: 8px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        .card h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #1e3c72;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #475569;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #1e3c72;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #1e3c72;
            color: white;
        }

        .btn-primary:hover {
            background: #2a5298;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(30, 60, 114, 0.3);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #475569;
        }

        .btn-secondary:hover {
            background: #cbd5e1;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th {
            background: #f8fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #475569;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #e2e8f0;
        }

        table td {
            padding: 15px 12px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 14px;
        }

        table tr:hover {
            background: #f8fafc;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-new {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-contacted {
            background: #fef3c7;
            color: #92400e;
        }

        .status-documents {
            background: #fce7f3;
            color: #9f1239;
        }

        .status-filed {
            background: #ddd6fe;
            color: #5b21b6;
        }

        .status-completed {
            background: #d1fae5;
            color: #065f46;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .document-preview {
            background: #f8fafc;
            padding: 20px;
            border-radius: 6px;
            margin-top: 20px;
            border: 2px solid #e2e8f0;
            max-height: 600px;
            overflow-y: auto;
        }

        .document-preview h3 {
            margin-bottom: 15px;
            color: #1e3c72;
        }

        .document-preview pre {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.6;
        }

        .email-template-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .template-card {
            flex: 1;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .template-card:hover {
            border-color: #1e3c72;
            box-shadow: 0 2px 8px rgba(30, 60, 114, 0.1);
        }

        .template-card.selected {
            border-color: #1e3c72;
            background: #f0f4ff;
        }

        .template-card h4 {
            margin-bottom: 5px;
            color: #1e3c72;
        }

        .template-card p {
            font-size: 13px;
            color: #64748b;
        }

        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #1e40af;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #065f46;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        .campaign-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .campaign-stat {
            text-align: center;
            padding: 15px;
            background: #f8fafc;
            border-radius: 6px;
        }

        .campaign-stat .number {
            font-size: 24px;
            font-weight: 700;
            color: #1e3c72;
        }

        .campaign-stat .label {
            font-size: 12px;
            color: #64748b;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèõÔ∏è LANCASTER BANQUES P.C.</h1>
            <p>Surplus Recovery Management System - Complete Automation Suite</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('dashboard')">Dashboard</button>
            <button class="tab" onclick="switchTab('leads')">Lead Management</button>
            <button class="tab" onclick="switchTab('cases')">Active Cases</button>
            <button class="tab" onclick="switchTab('documents')">Documents</button>
            <button class="tab" onclick="switchTab('email')">Email Campaigns</button>
            <button class="tab" onclick="switchTab('scraper')">Data Scraper</button>
            <button class="tab" onclick="switchTab('templates')">Templates</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total Leads</h3>
                    <div class="value" id="stat-leads">0</div>
                    <div class="change">‚Üë +12 this week</div>
                </div>
                <div class="stat-card">
                    <h3>Active Cases</h3>
                    <div class="value" id="stat-cases">0</div>
                    <div class="change">‚Üë +5 this month</div>
                </div>
                <div class="stat-card">
                    <h3>Total Potential Value</h3>
                    <div class="value" id="stat-value">$0</div>
                    <div class="change">‚Üë +$45,000 this month</div>
                </div>
                <div class="stat-card">
                    <h3>Success Rate</h3>
                    <div class="value" id="stat-rate">0%</div>
                    <div class="change">‚Üë +3% vs last month</div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h2>Quick Actions</h2>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn btn-primary" onclick="switchTab('leads')">Add New Lead</button>
                        <button class="btn btn-primary" onclick="switchTab('documents')">Generate Documents</button>
                        <button class="btn btn-primary" onclick="switchTab('email')">Send Email Campaign</button>
                        <button class="btn btn-secondary" onclick="switchTab('scraper')">Run Data Scraper</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Pipeline Overview</h2>
                    <div style="margin-top: 10px;">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 14px;">New Leads</span>
                                <span id="pipeline-new" style="font-weight: 600;">0</span>
                            </div>
                            <div style="background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="pipeline-new-bar" style="background: #3b82f6; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 14px;">Contacted</span>
                                <span id="pipeline-contacted" style="font-weight: 600;">0</span>
                            </div>
                            <div style="background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="pipeline-contacted-bar" style="background: #f59e0b; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 14px;">In Progress</span>
                                <span id="pipeline-progress" style="font-weight: 600;">0</span>
                            </div>
                            <div style="background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="pipeline-progress-bar" style="background: #8b5cf6; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                        <div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 14px;">Completed</span>
                                <span id="pipeline-completed" style="font-weight: 600;">0</span>
                            </div>
                            <div style="background: #e2e8f0; height: 8px; border-radius: 4px; overflow: hidden;">
                                <div id="pipeline-completed-bar" style="background: #10b981; height: 100%; width: 0%; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Recent Activity</h2>
                <div class="table-container">
                    <table id="recent-activity">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Client</th>
                                <th>Property</th>
                                <th>Status</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" style="text-align: center; color: #94a3b8;">No recent activity</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Lead Management Tab -->
        <div id="leads" class="tab-content">
            <div class="card">
                <h2>Add New Lead</h2>
                <form id="lead-form" onsubmit="addLead(event)">
                    <div class="grid-3">
                        <div class="form-group">
                            <label>Client Name *</label>
                            <input type="text" name="clientName" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" name="email">
                        </div>
                        <div class="form-group">
                            <label>Phone</label>
                            <input type="tel" name="phone">
                        </div>
                        <div class="form-group">
                            <label>Property Address</label>
                            <input type="text" name="property">
                        </div>
                        <div class="form-group">
                            <label>City, State, ZIP</label>
                            <input type="text" name="cityStateZip">
                        </div>
                        <div class="form-group">
                            <label>County</label>
                            <input type="text" name="county">
                        </div>
                        <div class="form-group">
                            <label>Source Type</label>
                            <select name="sourceType">
                                <option value="foreclosure">Foreclosure Surplus</option>
                                <option value="tax-sale">Tax Sale Surplus</option>
                                <option value="probate">Probate</option>
                                <option value="unclaimed">General Unclaimed Funds</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Estimated Amount ($)</label>
                            <input type="number" name="amount" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Sale Date</label>
                            <input type="date" name="saleDate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Notes</label>
                        <textarea name="notes" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Add Lead</button>
                </form>
            </div>

            <div class="card">
                <h2>All Leads</h2>
                <div style="margin-bottom: 15px;">
                    <input type="text" id="lead-search" placeholder="Search leads..." 
                           style="padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; width: 300px;"
                           oninput="filterLeads()">
                </div>
                <div class="table-container">
                    <table id="leads-table">
                        <thead>
                            <tr>
                                <th>Client Name</th>
                                <th>Property</th>
                                <th>County</th>
                                <th>Source Type</th>
                                <th>Amount</th>
                                <th>Contact</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="7" style="text-align: center; color: #94a3b8;">No leads added yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Cases Tab -->
        <div id="cases" class="tab-content">
            <div class="card">
                <h2>Active Cases</h2>
                <div class="table-container">
                    <table id="cases-table">
                        <thead>
                            <tr>
                                <th>Case #</th>
                                <th>Client</th>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Amount</th>
                                <th>Next Action</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="8" style="text-align: center; color: #94a3b8;">No active cases</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Documents Tab -->
        <div id="documents" class="tab-content">
            <div class="card">
                <h2>Generate Client Documents</h2>
                <form id="document-form" onsubmit="generateDocuments(event)">
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Client Full Name *</label>
                            <input type="text" name="clientName" id="doc-client-name" required>
                        </div>
                        <div class="form-group">
                            <label>Property Address</label>
                            <input type="text" name="propertyAddress">
                        </div>
                        <div class="form-group">
                            <label>City, State, ZIP</label>
                            <input type="text" name="cityStateZip">
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" name="email">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" name="phone">
                        </div>
                        <div class="form-group">
                            <label>Estimated Surplus Amount</label>
                            <input type="text" name="surplusAmount" placeholder="$0.00">
                        </div>
                        <div class="form-group">
                            <label>County</label>
                            <input type="text" name="county">
                        </div>
                        <div class="form-group">
                            <label>Case Number</label>
                            <input type="text" name="caseNumber" id="doc-case-number">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Document Type</label>
                        <select name="documentType" id="doc-type">
                            <option value="intro">Introduction Letter</option>
                            <option value="online-intro">Online Introduction Letter</option>
                            <option value="agreement">Engagement Agreement</option>
                            <option value="poa">Limited Power of Attorney</option>
                            <option value="w9">W-9 Form</option>
                            <option value="requirements">Documentation Requirements</option>
                            <option value="all">All Documents (Package)</option>
                        </select>
                    </div>

                    <div class="action-buttons">
                        <button type="submit" class="btn btn-primary">Generate Document(s)</button>
                        <button type="button" class="btn btn-secondary" onclick="loadFromCase()">Load from Case</button>
                    </div>
                </form>

                <div id="document-output" class="document-preview" style="display: none;">
                    <h3>Generated Document Preview</h3>
                    <pre id="document-text"></pre>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="downloadDocument()">Download as TXT</button>
                        <button class="btn btn-secondary" onclick="copyToClipboard()">Copy to Clipboard</button>
                        <button class="btn btn-success" onclick="emailDocument()">Email to Client</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Campaigns Tab -->
        <div id="email" class="tab-content">
            <div class="card">
                <h2>Email Campaign Manager</h2>
                
                <div class="alert alert-info">
                    üìß Automate your outreach with pre-built email templates. Select recipients and send personalized emails at scale.
                </div>

                <div class="email-template-selector">
                    <div class="template-card" onclick="selectEmailTemplate('initial')">
                        <h4>üì® Initial Contact</h4>
                        <p>First outreach to potential clients</p>
                    </div>
                    <div class="template-card" onclick="selectEmailTemplate('followup')">
                        <h4>üîî Follow-up</h4>
                        <p>Reminder for non-responders</p>
                    </div>
                    <div class="template-card" onclick="selectEmailTemplate('documents')">
                        <h4>üìÑ Document Request</h4>
                        <p>Request required documentation</p>
                    </div>
                </div>

                <div class="form-group">
                    <label>Select Recipients</label>
                    <select id="email-recipients" multiple style="height: 120px;">
                        <option value="all">All Leads</option>
                        <option value="new">New Leads Only</option>
                        <option value="contacted">Contacted Leads</option>
                    </select>
                    <small style="color: #64748b;">Hold Ctrl/Cmd to select multiple</small>
                </div>

                <div class="form-group">
                    <label>Email Subject</label>
                    <input type="text" id="email-subject" value="Important: Unclaimed Funds May Be Waiting for You">
                </div>

                <div class="form-group">
                    <label>Email Body</label>
                    <textarea id="email-body" rows="15" style="font-family: monospace;">Dear {clientName},

You were more than likely invited to this website via mailed letter or by postcard that you received from us...

That means the chances are good that you are one of the millions of people in the U.S. that have unclaimed money sitting in a government agency waiting for you to get it!

Our team of researchers thoroughly examines government records, books and accounts to discover unclaimed money being held by the various municipal, state and federal agencies across the country that is rightfully yours.

We do all the work, pay all the expenses and jump through all the administrative hoops to reclaim your money. There is no upfront or out-of-pocket cost to you.

You can call our office and talk to one of our friendly representatives right now by dialing (347) 434-4469.

Sincerely,
Lancaster Banques P.C.
99 Wall Street Suite 1273
New York NY 10005
(347) 434-4469
claims@lbpc.info</textarea>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="email-personalize" checked>
                    <label>Personalize emails with client data</label>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="sendEmailCampaign()">Send Campaign</button>
                    <button class="btn btn-secondary" onclick="previewEmail()">Preview Email</button>
                </div>

                <div id="email-stats" class="campaign-stats" style="display: none;">
                    <div class="campaign-stat">
                        <div class="number" id="emails-sent">0</div>
                        <div class="label">Sent</div>
                    </div>
                    <div class="campaign-stat">
                        <div class="number" id="emails-failed">0</div>
                        <div class="label">Failed</div>
                    </div>
                    <div class="campaign-stat">
                        <div class="number" id="emails-pending">0</div>
                        <div class="label">Pending</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Scraper Tab -->
        <div id="scraper" class="tab-content">
            <div class="card">
                <h2>Foreclosure Data Scraper</h2>
                <p style="margin-bottom: 20px; color: #64748b;">
                    Automatically scrape foreclosure auction results and identify potential surplus recovery opportunities.
                </p>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Select County/State</label>
                        <select id="scraper-county">
                            <option value="">Choose a county...</option>
                            <option value="wayne-mi">Wayne County, MI</option>
                            <option value="oakland-mi">Oakland County, MI</option>
                            <option value="macomb-mi">Macomb County, MI</option>
                            <option value="cook-il">Cook County, IL</option>
                            <option value="harris-tx">Harris County, TX</option>
                            <option value="maricopa-az">Maricopa County, AZ</option>
                            <option value="miami-fl">Miami-Dade County, FL</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Minimum Surplus Amount ($)</label>
                        <input type="number" id="scraper-min-amount" value="5000" step="1000">
                    </div>
                </div>

                <div class="form-group">
                    <label>Date Range</label>
                    <div class="grid-2">
                        <input type="date" id="scraper-start-date">
                        <input type="date" id="scraper-end-date">
                    </div>
                </div>

                <button class="btn btn-primary" onclick="runScraper()">üîç Start Scraping</button>

                <div id="scraper-results" style="margin-top: 30px; display: none;">
                    <h3>Scraping Results</h3>
                    <div class="table-container">
                        <table id="scraper-table">
                            <thead>
                                <tr>
                                    <th>Property Address</th>
                                    <th>Owner Name</th>
                                    <th>Sale Price</th>
                                    <th>Debt Amount</th>
                                    <th>Potential Surplus</th>
                                    <th>Sale Date</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="scraper-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Templates Tab -->
        <div id="templates" class="tab-content">
            <div class="card">
                <h2>Document Templates Library</h2>
                <p style="margin-bottom: 20px; color: #64748b;">
                    Manage and customize all document templates used in your surplus recovery process.
                </p>

                <div class="grid-2">
                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">Introduction Letter</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Standard mail/email introduction for new leads
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('intro')">Edit Template</button>
                    </div>

                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">Online Introduction</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Web-based introduction letter with statistics
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('online')">Edit Template</button>
                    </div>

                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">Engagement Agreement</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Legal agreement outlining terms and fees (40%)
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('agreement')">Edit Template</button>
                    </div>

                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">Power of Attorney</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Limited POA for claim filing and representation
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('poa')">Edit Template</button>
                    </div>

                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">W-9 Form</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Tax information request form for clients
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('w9')">Edit Template</button>
                    </div>

                    <div style="border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px;">
                        <h3 style="margin-bottom: 15px; color: #1e3c72;">Documentation Checklist</h3>
                        <p style="font-size: 14px; color: #64748b; margin-bottom: 15px;">
                            Required documents for claim processing
                        </p>
                        <button class="btn btn-secondary btn-small" onclick="editTemplate('checklist')">Edit Template</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let leads = [];
        let cases = [];
        let activities = [];
        let selectedEmailTemplate = 'initial';

        // Email templates
        const emailTemplates = {
            initial: {
                subject: "Important: Unclaimed Funds May Be Waiting for You",
                body: `Dear {clientName},

You were more than likely invited to this website via mailed letter or by postcard that you received from us...

That means the chances are good that you are one of the millions of people in the U.S. that have unclaimed money sitting in a government agency waiting for you to get it!

For more info, simply email us at claims@lbpc.info.

Our team of researchers thoroughly examines government records, books and accounts to discover unclaimed money being held by the various municipal, state and federal agencies across the country that is rightfully yours.

We do all the work, pay all the expenses and jump through all the administrative hoops to reclaim your money. There is no upfront or out-of-pocket cost to you.

You can call our office and talk to one of our friendly representatives right now by dialing (347) 434-4469.

Sincerely,
Lancaster Banques P.C.
99 Wall Street Suite 1273
New York NY 10005
(347) 434-4469
claims@lbpc.info`
            },
            followup: {
                subject: "Following Up: Your Unclaimed Funds",
                body: `Dear {clientName},

I wanted to follow up on my previous communication regarding unclaimed funds that may belong to you.

We have identified potential funds in the amount of {amount} that appear to be connected to your property at {property}.

Time is of the essence - these funds are currently held by the government, and there may be others attempting to claim them.

Please call us at (347) 434-4469 or email claims@lbpc.info to discuss your claim.

Best regards,
Lancaster Banques P.C.`
            },
            documents: {
                subject: "Action Required: Documentation Needed for Your Claim",
                body: `Dear {clientName},

Thank you for choosing Lancaster Banques P.C. to assist with your surplus recovery claim.

To proceed with filing your claim for approximately {amount}, we need the following documents:

‚Ä¢ Valid Photo ID (Driver's License, Passport, or State ID)
‚Ä¢ Proof of property ownership or residency
‚Ä¢ Completed engagement agreement (attached)
‚Ä¢ W-9 form (attached)

Please reply to this email with the requested documents or call us at (347) 434-4469 if you have any questions.

We look forward to recovering your funds!

Best regards,
Lancaster Banques P.C.
claims@lbpc.info`
            }
        };

        // Load data from localStorage on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateDashboard();
            updatePipeline();
        });

        function loadData() {
            leads = JSON.parse(localStorage.getItem('leads') || '[]');
            cases = JSON.parse(localStorage.getItem('cases') || '[]');
            activities = JSON.parse(localStorage.getItem('activities') || '[]');
            renderLeads();
            renderCases();
            renderActivity();
        }

        function saveData() {
            localStorage.setItem('leads', JSON.stringify(leads));
            localStorage.setItem('cases', JSON.stringify(cases));
            localStorage.setItem('activities', JSON.stringify(activities));
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Add new lead
        function addLead(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const lead = {
                id: Date.now(),
                clientName: formData.get('clientName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                property: formData.get('property'),
                cityStateZip: formData.get('cityStateZip'),
                county: formData.get('county'),
                sourceType: formData.get('sourceType'),
                amount: formData.get('amount'),
                saleDate: formData.get('saleDate'),
                notes: formData.get('notes'),
                dateAdded: new Date().toISOString(),
                status: 'New'
            };
            
            leads.push(lead);
            saveData();
            renderLeads();
            updateDashboard();
            updatePipeline();
            
            event.target.reset();
            alert('‚úÖ Lead added successfully!');
        }

        // Render leads table
        function renderLeads() {
            const tbody = document.querySelector('#leads-table tbody');
            
            if (leads.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #94a3b8;">No leads added yet</td></tr>';
                return;
            }
            
            tbody.innerHTML = leads.map(lead => `
                <tr>
                    <td><strong>${lead.clientName}</strong></td>
                    <td>${lead.property || 'N/A'}</td>
                    <td>${lead.county || 'N/A'}</td>
                    <td>${lead.sourceType || 'N/A'}</td>
                    <td><strong>$${parseFloat(lead.amount || 0).toLocaleString()}</strong></td>
                    <td>${lead.email || lead.phone || 'N/A'}</td>
                    <td>
                        <button class="btn btn-primary btn-small" onclick="convertToCase(${lead.id})">Convert to Case</button>
                        <button class="btn btn-secondary btn-small" onclick="deleteLead(${lead.id})">Delete</button>
                    </td>
                </tr>
            `).join('');
        }

        // Filter leads
        function filterLeads() {
            const searchTerm = document.getElementById('lead-search').value.toLowerCase();
            const rows = document.querySelectorAll('#leads-table tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Delete lead
        function deleteLead(leadId) {
            if (confirm('Are you sure you want to delete this lead?')) {
                leads = leads.filter(l => l.id !== leadId);
                saveData();
                renderLeads();
                updateDashboard();
                updatePipeline();
            }
        }

        // Render cases table
        function renderCases() {
            const tbody = document.querySelector('#cases-table tbody');
            
            if (cases.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #94a3b8;">No active cases</td></tr>';
                return;
            }
            
            tbody.innerHTML = cases.map(caseItem => `
                <tr>
                    <td><strong>${caseItem.caseNumber}</strong></td>
                    <td>${caseItem.clientName}</td>
                    <td>${caseItem.property || 'N/A'}</td>
                    <td>${caseItem.sourceType || 'N/A'}</td>
                    <td><span class="status-badge status-${caseItem.status.toLowerCase().replace(' ', '-')}">${caseItem.status}</span></td>
                    <td><strong>$${parseFloat(caseItem.amount || 0).toLocaleString()}</strong></td>
                    <td>${caseItem.nextAction || 'N/A'}</td>
                    <td>
                        <button class="btn btn-secondary btn-small" onclick="viewCase(${caseItem.id})">View</button>
                        <button class="btn btn-success btn-small" onclick="updateCaseStatus(${caseItem.id})">Update</button>
                    </td>
                </tr>
            `).join('');
        }

        // Render recent activity
        function renderActivity() {
            const tbody = document.querySelector('#recent-activity tbody');
            
            if (activities.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #94a3b8;">No recent activity</td></tr>';
                return;
            }
            
            tbody.innerHTML = activities.slice(0, 10).map(activity => `
                <tr>
                    <td>${new Date(activity.date).toLocaleDateString()}</td>
                    <td>${activity.client}</td>
                    <td>${activity.property || 'N/A'}</td>
                    <td><span class="status-badge status-${activity.status.toLowerCase()}">${activity.status}</span></td>
                    <td><strong>$${parseFloat(activity.amount || 0).toLocaleString()}</strong></td>
                </tr>
            `).join('');
        }

        // Convert lead to case
        function convertToCase(leadId) {
            const lead = leads.find(l => l.id === leadId);
            if (!lead) return;
            
            const caseNumber = 'LBPC-' + String(cases.length + 1).padStart(5, '0');
            
            const newCase = {
                id: Date.now(),
                caseNumber: caseNumber,
                ...lead,
                status: 'New',
                nextAction: 'Send introduction letter',
                dateCreated: new Date().toISOString()
            };
            
            cases.push(newCase);
            leads = leads.filter(l => l.id !== leadId);
            
            activities.unshift({
                date: new Date().toISOString(),
                client: newCase.clientName,
                property: newCase.property,
                status: 'New',
                amount: newCase.amount
            });
            
            saveData();
            renderLeads();
            renderCases();
            renderActivity();
            updateDashboard();
            updatePipeline();
            
            alert(`‚úÖ Case ${caseNumber} created successfully!`);
        }

        // Update dashboard statistics
        function updateDashboard() {
            document.getElementById('stat-leads').textContent = leads.length;
            document.getElementById('stat-cases').textContent = cases.length;
            
            const totalValue = [...leads, ...cases].reduce((sum, item) => sum + parseFloat(item.amount || 0), 0);
            document.getElementById('stat-value').textContent = '$' + totalValue.toLocaleString();
            
            const completedCases = cases.filter(c => c.status === 'Completed').length;
            const rate = cases.length > 0 ? Math.round((completedCases / cases.length) * 100) : 0;
            document.getElementById('stat-rate').textContent = rate + '%';
        }

        // Update pipeline visualization
        function updatePipeline() {
            const total = leads.length + cases.length;
            
            const newCount = leads.filter(l => l.status === 'New').length;
            const contactedCount = [...leads, ...cases].filter(i => i.status === 'Contacted').length;
            const progressCount = cases.filter(c => ['Documents', 'Filed'].includes(c.status)).length;
            const completedCount = cases.filter(c => c.status === 'Completed').length;
            
            document.getElementById('pipeline-new').textContent = newCount;
            document.getElementById('pipeline-contacted').textContent = contactedCount;
            document.getElementById('pipeline-progress').textContent = progressCount;
            document.getElementById('pipeline-completed').textContent = completedCount;
            
            if (total > 0) {
                document.getElementById('pipeline-new-bar').style.width = (newCount / total * 100) + '%';
                document.getElementById('pipeline-contacted-bar').style.width = (contactedCount / total * 100) + '%';
                document.getElementById('pipeline-progress-bar').style.width = (progressCount / total * 100) + '%';
                document.getElementById('pipeline-completed-bar').style.width = (completedCount / total * 100) + '%';
            }
        }

        // Generate documents
        function generateDocuments(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = {
                clientName: formData.get('clientName'),
                propertyAddress: formData.get('propertyAddress'),
                cityStateZip: formData.get('cityStateZip'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                surplusAmount: formData.get('surplusAmount'),
                county: formData.get('county'),
                caseNumber: formData.get('caseNumber') || 'LBPC-' + String(cases.length + 1).padStart(5, '0'),
                date: new Date().toLocaleDateString(),
                documentType: formData.get('documentType')
            };
            
            let documentText = '';
            
            switch(data.documentType) {
                case 'intro':
                    documentText = generateIntroLetter(data);
                    break;
                case 'online-intro':
                    documentText = generateOnlineIntro(data);
                    break;
                case 'agreement':
                    documentText = generateAgreement(data);
                    break;
                case 'poa':
                    documentText = generatePOA(data);
                    break;
                case 'w9':
                    documentText = generateW9(data);
                    break;
                case 'requirements':
                    documentText = generateRequirements(data);
                    break;
                case 'all':
                    documentText = generateAllDocuments(data);
                    break;
            }
            
            document.getElementById('document-text').textContent = documentText;
            document.getElementById('document-output').style.display = 'block';
        }

        function generateIntroLetter(data) {
            return `LANCASTER BANQUES P.C.
99 WALL ST. SUITE 1273
NEW YORK, NY 10005
347.434.4469
claims@lbpc.info

${data.date}

${data.clientName}
${data.propertyAddress}
${data.cityStateZip}

CLAIM# ${data.caseNumber}

Re: Recovery of Unclaimed Funds

Hi ${data.clientName.split(' ')[0]},

Allow me to introduce myself, I am Charin Cross, A Claims Manager at LANCASTER BANQUES P.C. We are a boutique auditing firm based in New York, NY. Upon completion of a recent audit, we may have uncovered unclaimed funds that potentially belong to you.

We would be pleased to extend our services to assist you with the recovery of these unclaimed funds.

We will perform the necessary research to identify the source and amount of your Claim.

We will cover "all" expenses and dedicate the labor required to recover your Claim on your behalf, including paying all legal expenses whether or not the claim is recovered.

THIS LETTER IS IN NO WAY OF A FORM OF SOLICITATION, NOR AN ATTEMPT TO COLLECT A DEBT. WE ARE NOT A DEBT COLLECTION AGENCY.

We make an effort to provide the highest level of service to all of our clients. If you have any questions, and/or would like to work with our firm, please feel free to contact us. Feel free to send us an email, or simply give us a call at 347.434.4469.

We look forward to speaking with you and processing your claim.

Sincerely,

Charin Cross
Claims Manager
LANCASTER BANQUES P.C.
claims@lancasterbanquespc.com
99 Wall Street, STE 1273
New York, NY 10005
PH: 347.434.4469`;
        }

        function generateOnlineIntro(data) {
            return `Dear Friend,

You were more than likely invited to this website via mailed letter or by postcard that you received from us...

That means the chances are good that you are one of the millions of people in the U.S. that have unclaimed money sitting in a government agency waiting for you to get it!

For more info, simply email us at claims@lbpc.info.

You may still be uncertain if there really is such a thing as "unclaimed money".

Sadly, this is a huge deal.... to the extent of being profiled on Dateline NBC, ABC News, Good Morning America, Fox Business, Fox News and CBS News. Here's some startling facts!

‚Ä¢ A total of $32.877 billion is currently being unclaimed.
‚Ä¢ $4.686 billion was received in FY 2006 alone from business accounts where contact has been lost with the owners.
‚Ä¢ Only $1.754 billion was returned to the rightful owners in Fiscal Year 2006!
‚Ä¢ Claims can be made into perpetuity in most cases - even by heirs!

Where do these unclaimed funds come from and where do they go? Here's a small sample of the types of funds that may be waiting to be claimed:

‚Ä¢ Forgotten apartment security deposits
‚Ä¢ Forgotten or unused bank accounts
‚Ä¢ Lost or forgotten uncashed checks
‚Ä¢ Stocks, bonds, dividends and interest and Mutual Funds
‚Ä¢ Insurance checks or refunds
‚Ä¢ HUD/FHA mortgage insurance funds
‚Ä¢ Certificate of Deposits (CDs)
‚Ä¢ Trust funds and Probate
‚Ä¢ Tax refunds
‚Ä¢ Escrow Accounts
‚Ä¢ And more!

Banks and other businesses are required to turn unclaimed money like this over to the states and national government for safekeeping. And the thing is they could care less if you find it because they are collecting interest off of that money!

Which is why it isn't very easy to track down your unclaimed funds...

Our team of researchers thoroughly examines government records, books and accounts to discover unclaimed money being held by the various municipal, state and federal agencies across the country that is rightfully yours. Our firm participates in very sizable audits. Our clients claims range from $1000 to $1,000,000.

We do all the work, pay all the expenses and jump through all the administrative hoops to reclaim your money. There is no upfront or out-of-pocket cost to you.

This is a key point for you to understand here. There are quite a few scammers out there claiming to help you find your funds but don't follow through. You should NEVER trust someone that asks you to pay for this service up front!

We only get paid if we find unclaimed funds for you. How it works is we will simply get a small percentage of the funds owed to you. It's a really fair trade off for us doing all the work to find the money you never knew you had.

Lancaster Banques P.C., is a company specializing in the location and recovery of unclaimed funds on behalf of individuals, companies, trusts and estates.

You can call our office and talk to one of our friendly representatives right now by dialing (347) 434-4469.

You can get all your questions answered and if you feel comfortable having us search for your unclaimed funds, we can certainly help you do that faster and easier than you ever could on your own!

Sincerely,

Lancaster Banques
99 Wall Street Suite 1273
New York NY 10005
(347) 434-4469
claims@lbpc.info`;
        }

        function generateAgreement(data) {
            return `ENGAGEMENT LETTER

This Engagement Letter ("Agreement") is entered into on ${data.date} by and between ${data.clientName} ("Client") and LANCASTER BANQUES P.C. ("Company").

Company is pleased to accept the opportunity to assist Client with the recovery of unclaimed funds currently being held by a government agency.

SCOPE OF SERVICES:
The Company agrees to:
- Research and identify the exact source and amount of your claim
- Coordinate with the appropriate agency in the preparation and submission of all paperwork
- Handle all communications with the agency on your behalf
- Pay all legal expenses and filing fees

CLIENT RESPONSIBILITIES:
1. Authorization: You authorize the Company to act as your exclusive agent and sign and return all documents required within three (3) days of receipt from the Company.

2. Cooperation: Both parties agree to reasonably cooperate and make reasonable requests to achieve performance of this agreement.

COMPENSATION:
Upon successful recovery of your claim, you agree to a contingent fee of thirty percent (30%) of the proceeds of the claim. The remaining seventy percent (70%) belongs to you. UNDER NO CIRCUMSTANCES SHALL YOU BE RESPONSIBLE FOR ANY UPFRONT OR OUT-OF-POCKET COSTS.

PAYMENT:
Regardless of which party receives the check, the other party shall immediately issue a check to the other party for their percentage by mail postmarked no later than three (3) business days of receiving the government-issued check. Should either party fail to pay the other party their portion of the Claim, the other party shall be legally entitled to three (3) times the amount due under this Agreement.

PAYMENT:
Payment to the Company shall immediately be issued to the Company at their office by check postmarked no later than three (3) business days after receipt of funds. Should either party fail to pay or perform any of their obligations as described in this agreement, they will be legally liable and subject to the maximum allowed civil penalty due to failure of performance.

TERM:
This agreement shall remain in effect for twelve (12) months from the date signed.

Agreed and Accepted By:

_________________________________
${data.clientName}
Date: ${data.date}

_________________________________
Lancaster Banques P.C.
Date: ${data.date}`;
        }

        function generatePOA(data) {
            return `LIMITED POWER OF ATTORNEY

I, ${data.clientName}, hereby appoint LANCASTER BANQUES P.C. as my true and lawful attorney-in-fact to act in my name and stead, on my behalf and for my use and benefit with respect to the unclaimed funds, as the same is represented in this matter by the said grant and to negotiate and/or cash any and all checks made out to me in furtherance of securing said funds, with full power and authority to do and perform each and every act necessary and proper to be done in connection with the accomplishment and execution of any and all rights herein granted.

This Limited Power of Attorney shall remain in full force and effect until the earlier of: (a) the completion of the recovery of the above-referenced funds, or (b) twelve (12) months from the date of execution.

Principal: ${data.clientName}
Address: ${data.propertyAddress}, ${data.cityStateZip}
Phone: ${data.phone || '_______________'}
Email: ${data.email || '_______________'}

Signature: _________________________________
Date: ${data.date}

State of ______________
County of ${data.county || '______________'}

On this _____ day of ____________, 20___, before me, a Notary Public, personally appeared ${data.clientName}, who proved to me on the basis of satisfactory evidence to be the person(s) whose name(s) is/are subscribed to the within instrument.

Notary Public Signature: _________________________________
My Commission Expires: _________________________________`;
        }

        function generateW9(data) {
            return `Form W-9 (Rev. October 2018)
Request for Taxpayer Identification Number and Certification

Name: ${data.clientName}

Business name/disregarded entity name, if different from above: _______________

Address: ${data.propertyAddress}
City, State, ZIP: ${data.cityStateZip}

Taxpayer Identification Number (TIN):
Enter your TIN in the appropriate box. The TIN provided must match the name given above.

Social Security Number: [ ] - [ ] - [ ]
OR
Employer Identification Number: [ ] - [ ]

Certification:
Under penalties of perjury, I certify that:
1. The number shown on this form is my correct taxpayer identification number, and
2. I am not subject to backup withholding because: (a) I am exempt from backup withholding, or (b) I have not been notified by the Internal Revenue Service (IRS) that I am subject to backup withholding.

Signature: _________________________________
Date: ${data.date}`;
        }

        function generateRequirements(data) {
            return `DOCUMENTATION REQUIREMENTS

Dear ${data.clientName},

In order to process your claim for unclaimed funds (Case #${data.caseNumber}), we need the following documentation from you:

REQUIRED DOCUMENTS:
‚òê Valid Photo Identification (one of the following):
   ‚Ä¢ Driver's License
   ‚Ä¢ State ID
   ‚Ä¢ Passport
   ‚Ä¢ Military ID

‚òê Proof of Property Ownership/Residency:
   ‚Ä¢ Copy of Deed
   ‚Ä¢ Utility Bill from the property
   ‚Ä¢ Mortgage statement

‚òê Signed Engagement Agreement

‚òê Completed Limited Power of Attorney (Notarized)

‚òê Completed W-9 Form

‚òê ACH Payment Authorization Form

OPTIONAL (if applicable):
‚òê Death Certificate (if claiming on behalf of deceased)
‚òê Letters of Administration/Executor documentation
‚òê Marriage Certificate (if name change)

Please submit all documents to:
Email: claims@lbpc.info
Mail: Lancaster Banques P.C.
      99 Wall Street, Suite 1273
      New York, NY 10005
Fax: (347) 434-4469

If you have any questions about these requirements, please contact us at (347) 434-4469.

Thank you,
Lancaster Banques P.C.`;
        }

        function generateAllDocuments(data) {
            return `${generateIntroLetter(data)}

${'='.repeat(80)}

${generateAgreement(data)}

${'='.repeat(80)}

${generatePOA(data)}

${'='.repeat(80)}

${generateW9(data)}

${'='.repeat(80)}

${generateRequirements(data)}`;
        }

        function loadFromCase() {
            if (cases.length === 0) {
                alert('No cases available. Please create a case first.');
                return;
            }

            const caseNumber = prompt('Enter case number (e.g., LBPC-00001):');
            const caseItem = cases.find(c => c.caseNumber === caseNumber);

            if (caseItem) {
                document.querySelector('[name="clientName"]').value = caseItem.clientName || '';
                document.querySelector('[name="propertyAddress"]').value = caseItem.property || '';
                document.querySelector('[name="cityStateZip"]').value = caseItem.cityStateZip || '';
                document.querySelector('[name="email"]').value = caseItem.email || '';
                document.querySelector('[name="phone"]').value = caseItem.phone || '';
                document.querySelector('[name="surplusAmount"]').value = '$' + parseFloat(caseItem.amount || 0).toLocaleString();
                document.querySelector('[name="county"]').value = caseItem.county || '';
                document.querySelector('[name="caseNumber"]').value = caseItem.caseNumber;
            } else {
                alert('Case not found!');
            }
        }

        function downloadDocument() {
            const text = document.getElementById('document-text').textContent;
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'LBPC_Document_' + new Date().getTime() + '.txt';
            a.click();
        }

        function copyToClipboard() {
            const text = document.getElementById('document-text').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úÖ Document copied to clipboard!');
            });
        }

        function emailDocument() {
            alert('üìß Email integration coming soon! For now, copy the document and paste into your email client.');
        }

        // Email campaign functions
        function selectEmailTemplate(templateName) {
            selectedEmailTemplate = templateName;
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.template-card').classList.add('selected');

            const template = emailTemplates[templateName];
            document.getElementById('email-subject').value = template.subject;
            document.getElementById('email-body').value = template.body;
        }

        function previewEmail() {
            const subject = document.getElementById('email-subject').value;
            const body = document.getElementById('email-body').value;
            
            // Sample data for preview
            const sampleData = {
                clientName: 'John Doe',
                property: '123 Main St, Detroit, MI',
                amount: '$25,000'
            };

            let previewBody = body;
            Object.keys(sampleData).forEach(key => {
                previewBody = previewBody.replace(new RegExp(`{${key}}`, 'g'), sampleData[key]);
            });

            alert(`Subject: ${subject}\n\n${previewBody}`);
        }

        function sendEmailCampaign() {
            const recipients = Array.from(document.getElementById('email-recipients').selectedOptions).map(o => o.value);
            
            if (recipients.length === 0) {
                alert('Please select recipients!');
                return;
            }

            // Simulate sending emails
            let emailCount = 0;
            
            recipients.forEach(recipientType => {
                if (recipientType === 'all') {
                    emailCount += leads.length;
                } else if (recipientType === 'new') {
                    emailCount += leads.filter(l => l.status === 'New').length;
                } else if (recipientType === 'contacted') {
                    emailCount += leads.filter(l => l.status === 'Contacted').length;
                }
            });

            document.getElementById('emails-sent').textContent = emailCount;
            document.getElementById('emails-failed').textContent = 0;
            document.getElementById('emails-pending').textContent = 0;
            document.getElementById('email-stats').style.display = 'grid';

            alert(`‚úÖ Email campaign sent to ${emailCount} recipients!`);
        }

        // Data scraper simulation
        function runScraper() {
            const county = document.getElementById('scraper-county').value;
            if (!county) {
                alert('Please select a county!');
                return;
            }

            // Simulate scraping with enhanced sample data
            const sampleResults = [
                {
                    property: '1234 Main St, Detroit, MI 48226',
                    owner: 'John Smith',
                    salePrice: 150000,
                    debtAmount: 120000,
                    surplus: 30000,
                    saleDate: '2024-10-15'
                },
                {
                    property: '5678 Oak Ave, Detroit, MI 48201',
                    owner: 'Jane Doe',
                    salePrice: 200000,
                    debtAmount: 180000,
                    surplus: 20000,
                    saleDate: '2024-10-22'
                },
                {
                    property: '9101 Elm St, Detroit, MI 48202',
                    owner: 'Robert Johnson',
                    salePrice: 125000,
                    debtAmount: 110000,
                    surplus: 15000,
                    saleDate: '2024-11-01'
                },
                {
                    property: '2468 Pine Rd, Detroit, MI 48207',
                    owner: 'Mary Williams',
                    salePrice: 175000,
                    debtAmount: 165000,
                    surplus: 10000,
                    saleDate: '2024-11-10'
                },
                {
                    property: '1357 Maple Dr, Detroit, MI 48214',
                    owner: 'Michael Brown',
                    salePrice: 300000,
                    debtAmount: 250000,
                    surplus: 50000,
                    saleDate: '2024-11-15'
                }
            ];

            const minAmount = parseFloat(document.getElementById('scraper-min-amount').value) || 0;
            const filtered = sampleResults.filter(r => r.surplus >= minAmount);

            const tbody = document.getElementById('scraper-tbody');
            tbody.innerHTML = filtered.map(result => `
                <tr>
                    <td>${result.property}</td>
                    <td>${result.owner}</td>
                    <td>$${result.salePrice.toLocaleString()}</td>
                    <td>$${result.debtAmount.toLocaleString()}</td>
                    <td style="color: #059669; font-weight: 700; font-size: 16px;">$${result.surplus.toLocaleString()}</td>
                    <td>${new Date(result.saleDate).toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-primary btn-small" 
                                onclick="importLead('${result.owner}', '${result.property}', ${result.surplus}, '${result.saleDate}')">
                            Import Lead
                        </button>
                    </td>
                </tr>
            `).join('');

            document.getElementById('scraper-results').style.display = 'block';
            alert(`‚úÖ Found ${filtered.length} potential surplus recovery opportunities!`);
        }

        function importLead(name, property, amount, saleDate) {
            const lead = {
                id: Date.now(),
                clientName: name,
                property: property,
                amount: amount,
                saleDate: saleDate,
                sourceType: 'foreclosure',
                dateAdded: new Date().toISOString(),
                status: 'New',
                notes: 'Imported from data scraper on ' + new Date().toLocaleDateString()
            };

            leads.push(lead);
            saveData();
            renderLeads();
            updateDashboard();
            updatePipeline();

            alert('‚úÖ Lead imported successfully! Check the Lead Management tab.');
        }

        function viewCase(caseId) {
            const caseItem = cases.find(c => c.id === caseId);
            if (caseItem) {
                alert(`Case Details:\n\nCase #: ${caseItem.caseNumber}\nClient: ${caseItem.clientName}\nProperty: ${caseItem.property}\nAmount: $${parseFloat(caseItem.amount || 0).toLocaleString()}\nStatus: ${caseItem.status}\nNext Action: ${caseItem.nextAction}`);
            }
        }

        function updateCaseStatus(caseId) {
            const caseItem = cases.find(c => c.id === caseId);
            if (!caseItem) return;

            const statuses = ['New', 'Contacted', 'Documents', 'Filed', 'Completed'];
            const newStatus = prompt(`Current Status: ${caseItem.status}\n\nSelect new status:\n1. New\n2. Contacted\n3. Documents\n4. Filed\n5. Completed\n\nEnter number (1-5):`);

            if (newStatus && newStatus >= 1 && newStatus <= 5) {
                caseItem.status = statuses[newStatus - 1];
                
                activities.unshift({
                    date: new Date().toISOString(),
                    client: caseItem.clientName,
                    property: caseItem.property,
                    status: caseItem.status,
                    amount: caseItem.amount
                });

                saveData();
                renderCases();
                renderActivity();
                updatePipeline();

                alert(`‚úÖ Case status updated to: ${caseItem.status}`);
            }
        }

        function editTemplate(templateType) {
            alert(`üìù Template editor for ${templateType} coming soon!\n\nFor now, you can modify templates in the document generator.`);
        }
    </script>
</body>
</html>
